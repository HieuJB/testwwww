import{c as Y}from"./CF2VPTuC.js";import{d as ee,c4 as te,r as i,w as se,t as j,e as Z,o as T,c as q,h as t,v as y,bG as w,i as v,k as M,V as oe,C as ae,D as le,E as ne,_ as ie,j as re,l as de}from"./CnJNAMZb.js";import{a as ce,A as ue}from"./Bxk5PY0E.js";import{a as me}from"./DuHqTucL.js";const _=h=>(ae("data-v-421743c2"),h=h(),le(),h),pe={class:"txtBox"},ve=_(()=>t("span",{class:"icon iconfont icon-font-username"},null,-1)),_e={class:"txtBox"},he=_(()=>t("span",{class:"icon iconfont icon-font-mail"},null,-1)),ge={class:"txtBox"},fe=_(()=>t("span",{class:"icon iconfont icon-font-username"},null,-1)),xe={class:"txtBox"},ke=_(()=>t("span",{class:"icon iconfont icon-font-password"},null,-1)),be={class:"txtBox"},ye=_(()=>t("span",{class:"icon iconfont icon-font-password"},null,-1)),we=_(()=>t("div",{id:"lg_msg"},null,-1)),Me=ee({__name:"RegisterForm.client",emits:["closeModalRegister","openModalLogin"],setup(h,{emit:B}){const r=te(),l=me(),R=B,g=i(!1),d=i(""),f=i(""),u=i(""),n=i(""),m=i(""),N=i(""),H=i(!1),s=i([]),J=async()=>{var c,e,o,x,k,b,F,I,V,U,L,O,P,z,A,D,G;try{const{data:a,pending:S,error:p,refresh:Fe}=await ce(ue.AUTH.REGISTER,{method:"POST",body:{user_name:d.value,nick_name:d.value,email:u.value?u.value:null,phone:N.value,password:n.value,passwordConfirm:m.value}},"$66udBtRn6p");if(p.value){typeof((o=(e=(c=p.value)==null?void 0:c.data)==null?void 0:e.data)==null?void 0:o.detail)=="string"?s.value=[{msg:(b=(k=(x=p.value)==null?void 0:x.data)==null?void 0:k.data)==null?void 0:b.detail}]:s.value=(V=(I=(F=p.value)==null?void 0:F.data)==null?void 0:I.data)==null?void 0:V.detail;let C="";(U=s.value)==null||U.forEach(E=>C+=E==null?void 0:E.msg),C&&r.add({type:"error",text:C})}else r.add({type:"success",text:(L=a==null?void 0:a.value)!=null&&L.message?(O=a==null?void 0:a.value)==null?void 0:O.message:"Đăng ký thành công."}),ne(()=>{W(),R("closeModalRegister",!0)})}catch(a){(z=(P=a==null?void 0:a.response)==null?void 0:P._data)!=null&&z.detail?s.value=[{msg:(D=(A=a==null?void 0:a.response)==null?void 0:A._data)==null?void 0:D.detail}]:s.value=[{msg:"Có lỗi xẩy ra trong quá trình đăng ký."}];let S="";s!=null&&s.value&&((G=s.value)==null||G.forEach(p=>S+=p==null?void 0:p.msg),S&&r.add({type:"error",text:S}))}},K=c=>{var o,x,k,b;s.value=[];let e="";if(!((o=String(d.value))!=null&&o.trim()))return e="Biệt danh là bắt buộc.",s.value.push({msg:e}),r.add({type:"error",text:e}),!1;if(!((x=String(n.value))!=null&&x.trim()))return e="Mật khẩu là bắt buộc.",s.value.push({msg:e}),r.add({type:"error",text:e}),!1;if(!((k=String(m.value))!=null&&k.trim()))return e="Nhập lại mật khẩu là bắt buộc.",s.value.push({msg:e}),r.add({type:"error",text:e}),!1;if(n.value&&m.value&n.value!==m.value)return e="Nhập lại mật khẩu phải trùng mật khẩu.",s.value.push({msg:e}),r.add({type:"error",text:e}),!1;if(u.value&&!Q(u.value))return e="Email không đúng định dạng.",s.value.push({msg:e}),r.add({type:"error",text:e}),!1;if(!((b=s.value)!=null&&b.length))return!0},Q=c=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(c),$=c=>{var e;K(),(e=s.value)!=null&&e.length||J()},W=()=>{d.value="",f.value="",u.value="",n.value="",m.value="",s.value=[],N.value=""},X=()=>{R("openModalLogin",!0)};return se(l,()=>{l!=null&&l.isOpenRegisterForm&&(g.value=l==null?void 0:l.isOpenRegisterForm)}),j(()=>{const c=Z("userNickname").value,e=Z("userPassword").value;c&&e&&(d.value=c,n.value=e,H.value=!0)}),(c,e)=>(T(),q("form",{id:"lg_form",name:"lg_form",method:"post",onSubmit:oe($,["prevent"])},[t("div",pe,[ve,y(t("input",{id:"mobile","onUpdate:modelValue":e[0]||(e[0]=o=>M(f)?f.value=o:null),type:"text",placeholder:"Số điện thoại",title:"Số điện thoại"},null,512),[[w,v(f)]])]),t("div",_e,[he,y(t("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>M(u)?u.value=o:null),type:"text",placeholder:"Email",title:"Email"},null,512),[[w,v(u)]])]),t("div",ge,[fe,y(t("input",{id:"nickname","onUpdate:modelValue":e[2]||(e[2]=o=>M(d)?d.value=o:null),type:"text",placeholder:"Tài khoản",title:"Tài khoản"},null,512),[[w,v(d)]])]),t("div",xe,[ke,y(t("input",{id:"password","onUpdate:modelValue":e[3]||(e[3]=o=>M(n)?n.value=o:null),autocomplete:"on",type:"password",placeholder:"Mật khẩu",title:"Mật khẩu"},null,512),[[w,v(n)]])]),t("div",be,[ye,y(t("input",{id:"repassword","onUpdate:modelValue":e[4]||(e[4]=o=>M(m)?m.value=o:null),type:"password",title:"Nhập lại mật khẩu",placeholder:"Nhập lại mật khẩu"},null,512),[[w,v(m)]])]),we,t("div",{class:"row"},[t("div",{class:"col-12"},[t("div",{class:"button--max button--success col-12 inline",onClick:$},"Đăng ký ")])]),t("div",{class:"row"},[t("div",{class:"col-12"},[t("div",{class:"button button--max col-12 inline",onClick:X},"Đăng nhập")])])],32))}}),Re=ie(Me,[["__scopeId","data-v-421743c2"]]),Se=Y(Re),Be={ref:"modalRegister",class:"modal fade",id:"modal_register",tabindex:"-1","aria-labelledby":"modal_register_label","aria-hidden":"true"},Ce={class:"modal-dialog modal-dialog-centered"},Ee={class:"modal-content"},Te=t("div",{class:"modal-header d-none"},[t("div",{class:"modal-title",id:"modal_register_label"},"Đăng ký"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ne={id:"login_body",class:"regBox"},$e=t("div",{class:"mh2"}," Đăng ký ",-1),Oe={__name:"ModalRegister",emits:["openModalLogin"],setup(h,{emit:B}){const r=B,l=i(null),R=i(!0);j(()=>{l.value=new bootstrap.Modal(document.getElementById("modal_register"),{}),l.value.show()});const g=async()=>{l.value&&l.value.hide()},d=()=>{g(),setTimeout(()=>{r("openModalLogin")},200)};return(f,u)=>{const n=Se;return T(),q("div",Be,[t("div",Ce,[t("div",Ee,[Te,t("div",Ne,[t("div",{class:"title"},[t("span",{onClick:d,class:"peer icon iconfont icon-font-return back"}),$e,t("span",{class:"iconfont icon-close",onClick:g})]),v(R)?(T(),re(n,{key:0,onCloseModalRegister:g})):de("",!0)])])])],512)}}};export{Oe as default};
